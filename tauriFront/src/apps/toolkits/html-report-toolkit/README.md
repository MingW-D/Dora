# HTML报告生成工具包

这个工具包提供了生成美观HTML报告的功能，可以总结对话内容和任务执行结果。

## 功能特点

- 📊 生成包含完整对话记录的HTML报告
- 🎨 现代化、美观的UI设计
- 📱 响应式布局，支持多种设备
- 🖥️ 在Studio面板中实时预览
- 💾 一键下载保存到本地
- ⚙️ 可配置报告内容（消息、任务等）

## 使用方法

工具名称：`HtmlReportTool`

### 参数

- `title` (可选): 报告标题，默认为 "Dora AI 对话报告"
- `summary` (可选): 内容摘要
- `includeMessages` (可选): 是否包含对话消息，默认为 true
- `includeTasks` (可选): 是否包含任务执行记录，默认为 true  
- `fileName` (可选): HTML文件名，默认使用时间戳

### 示例用法

```json
{
  "title": "项目讨论报告",
  "summary": "本次对话主要讨论了新功能的实现方案",
  "includeMessages": true,
  "includeTasks": true,
  "fileName": "project_discussion_report.html"
}
```

## 生成的报告包含

1. **报告概要** - 标题、时间戳、统计信息
2. **内容摘要** - 可选的对话总结
3. **对话记录** - 完整的消息历史，包括工具调用
4. **任务记录** - AI执行的计划和步骤状态

## 工作流程

1. **📊 数据收集**：从本地SQLite数据库获取对话消息和任务记录
2. **🎨 HTML生成**：使用内置模板生成美观的HTML报告
3. **🖥️ Studio展示**：在Studio面板中实时预览报告内容
4. **💾 用户下载**：点击下载按钮保存到本地文件

## 新特性

- ✨ **无需预保存**：不再自动保存到固定目录
- 🖱️ **用户控制**：用户主动选择是否下载
- 🔍 **实时预览**：在Studio面板中即时查看报告效果
- 📁 **自定义保存**：下载时可自定义文件名和保存位置

## 技术实现

- 使用本地SQLite数据库获取数据
- 在Studio面板中添加专用的htmlReport模式
- 使用iframe的srcdoc属性直接渲染HTML内容
- 通过Blob API和URL.createObjectURL实现下载功能
- 包含现代化CSS样式和响应式设计